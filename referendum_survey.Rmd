---
title: "week_5_lab"
author: "Max_B"
date: "2025-08-11"
output: pdf_document
---

```{r, message=FALSE, echo=FALSE, warning=FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
referendum_raw <- referendum_survey_lab_version
referendum_raw %>%
  summarise(across(everything(), ~ sum(is.na(.)))) %>%
  pivot_longer(cols = everything(),
               names_to = "Variable",
               values_to = "Missing_Count") %>%
  arrange(desc(Missing_Count)) %>%
  knitr::kable(
    caption = "Number Of Missing Values"
  ) %>%
  kable_styling(full_width = FALSE)
```
```{r, message=FALSE, echo=FALSE, warning=FALSE}
referendum_clean = referendum_raw |>
  drop_na()

ggplot(referendum_clean, aes(x = age)) +
  geom_histogram(alpha = 0.6, fill = "black") +
  facet_wrap(~ gender, ncol = 2) +
  labs(title = "Age Distribution by Gender",
       x = "Age", y = "Counts") +
  theme_minimal()

```


The distribution shows that most of the respondents identify as either male of female with most of them being in the 40 - 70 age bracket. The female distribution seems the be symmetrical and the male of looks to have a slighly left-skew.

The other gender categorizes dont have nearly have as much data/observations making it alot harder to interpret any trends. I would recommend the client collect more sampling to make good analysis on these other genders.

So because of the lack of data in the other categorizes most of the conclusions made will be based upon the male female data.

```{r, echo=FALSE}
library(broom)
ref_model <- glm(referendum ~ age + gender,
                 data = referendum_raw,
                 family = binomial)
tidy(ref_model) %>%
  mutate(term = gsub("gender", "", term)) %>%
  kable(caption = "Logistic regression predictors of voting",
        col.names = c("Term", "Estimate", "Standard Error", "z-value", "P-value"),
        align = "c",
        escape = TRUE,
        booktabs = TRUE)
        
```


The logistic regression predictors suggest that age and gender appear to have influence to chance of a YES vote. It seems that for age with at estimate of -0.029 means that younger voters are likely to vote yes.Female voters are more likely to vote YES then males as we can see with the estimates of -0.41 for males and 1.99 for females. For the other categorizes we don't have a big enough sample size and so they are insignificant (pvalue > 0.05). This means we cant draw any reliable conclusions.

```{r, echo=FALSE}


```












